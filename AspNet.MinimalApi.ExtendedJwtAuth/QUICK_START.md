# üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç - Detailed JWT Authentication

## ‚ö° –ó–∞–ø—É—Å–∫ –∑–∞ 5 —Ö–≤–∏–ª–∏–Ω

### 1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ —É –≤–∞—Å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:

- ‚úÖ .NET 9 SDK
- ‚úÖ IDE (Visual Studio, VS Code, Rider)

### 2. –ö–ª–æ–Ω—É–π—Ç–µ —Ç–∞ –∑–∞–ø—É—Å—Ç—ñ—Ç—å:

```bash
# –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ –ø–∞–ø–∫—É –ø—Ä–æ—î–∫—Ç—É
cd AspNet.MinimalApi.ExtendedJwtAuth

# –í—ñ–¥–Ω–æ–≤—ñ—Ç—å –ø–∞–∫–µ—Ç–∏
dotnet restore

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–æ–¥–∞—Ç–æ–∫
dotnet run
```

### 3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ:

- üåê **API**: https://localhost:7001
- üìñ **Swagger**: https://localhost:7001/swagger

## üß™ –®–≤–∏–¥–∫–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

```bash
curl -X POST https://localhost:7001/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email":"test@example.com",
    "password":"Test123!",
    "confirmPassword":"Test123!",
    "firstName":"–¢–µ—Å—Ç",
    "lastName":"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á"
  }'
```

**–û—á—ñ–∫—É–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:**

```json
{
  "success": true,
  "message": "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —É—Å–ø—ñ—à–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "base64_encoded_refresh_token",
    "expiresAt": "2024-01-01T13:00:00Z",
    "user": {
      "id": "user_id",
      "email": "test@example.com",
      "firstName": "–¢–µ—Å—Ç",
      "lastName": "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á"
    }
  }
}
```

### –ö—Ä–æ–∫ 2: –£–≤—ñ–π–¥—ñ—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É

```bash
curl -X POST https://localhost:7001/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email":"test@example.com",
    "password":"Test123!"
  }'
```

### –ö—Ä–æ–∫ 3: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Ç–æ–∫–µ–Ω

```bash
# –ó–∞–º—ñ–Ω—ñ—Ç—å YOUR_TOKEN –Ω–∞ –æ—Ç—Ä–∏–º–∞–Ω–∏–π accessToken
curl -X GET https://localhost:7001/auth/profile \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### –ö—Ä–æ–∫ 4: –û–Ω–æ–≤—ñ—Ç—å —Ç–æ–∫–µ–Ω

```bash
# –ó–∞–º—ñ–Ω—ñ—Ç—å YOUR_REFRESH_TOKEN –Ω–∞ –æ—Ç—Ä–∏–º–∞–Ω–∏–π refreshToken
curl -X POST https://localhost:7001/auth/refresh \
  -H "Content-Type: application/json" \
  -d '{"refreshToken":"YOUR_REFRESH_TOKEN"}'
```

## üìã –î–æ—Å—Ç—É–ø–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏

### üîì –ü—É–±–ª—ñ—á–Ω—ñ (–±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó):

- `GET /` - –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ API
- `POST /auth/register` - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
- `POST /auth/login` - –í—Ö—ñ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `POST /auth/refresh` - –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞
- `POST /auth/logout` - –í–∏—Ö—ñ–¥ –∑ —Å–∏—Å—Ç–µ–º–∏

### üîí –ó–∞—Ö–∏—â–µ–Ω—ñ (–ø–æ—Ç—Ä–µ–±—É—é—Ç—å —Ç–æ–∫–µ–Ω–∞):

- `GET /auth/profile` - –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `PUT /auth/profile` - –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é
- `PUT /auth/change-password` - –ó–º—ñ–Ω–∞ –ø–∞—Ä–æ–ª—è
- `GET /users` - –°–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

## üîë –Ø–∫ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ç–æ–∫–µ–Ω–∞–º–∏

### 1. –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤:

- –ü—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∞–±–æ –≤—Ö–æ–¥—ñ –æ—Ç—Ä–∏–º—É—î—Ç–µ `accessToken` —Ç–∞ `refreshToken`
- `accessToken` - –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ API (–¥—ñ—î 60 —Ö–≤)
- `refreshToken` - –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞ (–¥—ñ—î 7 –¥–Ω—ñ–≤)

### 2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤:

```bash
# –î–æ–¥–∞–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization –¥–æ –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É
Authorization: Bearer YOUR_ACCESS_TOKEN
```

### 3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤:

```bash
# –ö–æ–ª–∏ accessToken –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ refreshToken
POST /auth/refresh
{
  "refreshToken": "YOUR_REFRESH_TOKEN"
}
```

## üõ†Ô∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏

### –ó–º—ñ–Ω–∞ –ø–æ—Ä—Ç—ñ–≤:

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `Properties/launchSettings.json`:

```json
{
  "applicationUrl": "https://localhost:7001;http://localhost:5001"
}
```

### –ó–º—ñ–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å JWT:

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `appsettings.Development.json`:

```json
{
  "JwtSettings": {
    "ExpirationMinutes": 120,
    "RefreshExpirationDays": 30
  }
}
```

### –ó–º—ñ–Ω–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `appsettings.json`:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=my_custom_db.db"
  }
}
```

## üêõ –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "JWT SecretKey –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π"

**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `appsettings.json` - –º–∞—î –±—É—Ç–∏ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –º—ñ–Ω—ñ–º—É–º 32 —Å–∏–º–≤–æ–ª–∏.

### –ü—Ä–æ–±–ª–µ–º–∞: "Database –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è"

**–†—ñ—à–µ–Ω–Ω—è:**

```bash
dotnet ef migrations add InitialCreate
dotnet ef database update
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–¢–æ–∫–µ–Ω –Ω–µ–¥—ñ–π—Å–Ω–∏–π"

**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

- –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∏–π —Ç–æ–∫–µ–Ω
- –ß–∏ –Ω–µ –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó
- –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer TOKEN`

### –ü—Ä–æ–±–ª–µ–º–∞: "CORS –ø–æ–º–∏–ª–∫–∏"

**–†—ñ—à–µ–Ω–Ω—è:** –î–æ–¥–∞–π—Ç–µ CORS –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ `Program.cs`:

```csharp
builder.Services.AddCors(options =>
{
    options.AddDefaultPolicy(policy =>
    {
        policy.AllowAnyOrigin()
              .AllowAnyMethod()
              .AllowAnyHeader();
    });
});

app.UseCors();
```

## üìö –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é**: `README.md`
2. **–í–∏–≤—á—ñ—Ç—å –∫–æ–¥**: –ü–æ—á–Ω—ñ—Ç—å –∑ `Program.cs`
3. **–ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ API**: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ `ExtendedJwtAuth.http`
4. **–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–π—Ç–µ**: –î–æ–¥–∞–π—Ç–µ –Ω–æ–≤—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏
5. **–í–∏–≤—á—ñ—Ç—å —Å–µ—Ä–≤—ñ—Å–∏**: `Services/AuthService.cs` —Ç–∞ `Services/JwtService.cs`

## üéì –ù–∞–≤—á–∞–ª—å–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

### –õ–µ–≥–∫–∏–π —Ä—ñ–≤–µ–Ω—å (15-30 —Ö–≤):

- [ ] –î–æ–¥–∞–π—Ç–µ –ø–æ–ª–µ "–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è" –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- [ ] –°—Ç–≤–æ—Ä—ñ—Ç—å –µ–Ω–¥–ø–æ—ñ–Ω—Ç –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- [ ] –î–æ–¥–∞–π—Ç–µ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—É

### –°–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å (1-2 –≥–æ–¥–∏–Ω–∏):

- [ ] –†–µ–∞–ª—ñ–∑—É–π—Ç–µ —Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- [ ] –î–æ–¥–∞–π—Ç–µ –µ–Ω–¥–ø–æ—ñ–Ω—Ç —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤
- [ ] –°—Ç–≤–æ—Ä—ñ—Ç—å middleware –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤

### –°–∫–ª–∞–¥–Ω–∏–π —Ä—ñ–≤–µ–Ω—å (3-5 –≥–æ–¥–∏–Ω):

- [ ] –î–æ–¥–∞–π—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email
- [ ] –†–µ–∞–ª—ñ–∑—É–π—Ç–µ –¥–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
- [ ] –Ü–Ω—Ç–µ–≥—Ä—É–π—Ç–µ Google OAuth

## üí° –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

```bash
# –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
dotnet run --verbosity detailed

# –ó–∞–ø—É—Å–∫ –∑ —ñ–Ω—à–∏–º –ø—Ä–æ—Ñ—ñ–ª–µ–º
dotnet run --environment Production

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—ó
dotnet ef migrations add AddNewField

# –ü–µ—Ä–µ–≥–ª—è–¥ SQL –∫–æ–º–∞–Ω–¥
dotnet ef migrations script

# –í–∏–¥–∞–ª–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
dotnet ef database drop --force
```

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä —É –≤–∞—Å —î –ø–æ–≤–Ω–æ—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π JWT API –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—î—é! üéâ
