# ASP.NET Core Identity Authentication - Minimal API

–¶–µ–π –ø—Ä–æ—î–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ **ASP.NET Core Identity** –≤ **Minimal API** –¥–ª—è .NET 9.

## üéØ –ú–µ—Ç–∞ –ø—Ä–æ—î–∫—Ç—É

–ü–æ–∫–∞–∑–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞–º, —è–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ ASP.NET Core Identity –≤ Minimal API –¥–æ–¥–∞—Ç–æ–∫ –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏ –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É.

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
AspNet.MinimalApi.IdentityAuth/
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îî‚îÄ‚îÄ User.cs                    # –ú–æ–¥–µ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—Ä–æ–∑—à–∏—Ä—é—î IdentityUser)
‚îú‚îÄ‚îÄ Data/
‚îÇ   ‚îî‚îÄ‚îÄ ApplicationDbContext.cs    # –ö–æ–Ω—Ç–µ–∫—Å—Ç –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –¥–ª—è Identity
‚îú‚îÄ‚îÄ Extensions/
‚îÇ   ‚îî‚îÄ‚îÄ MigrationExtensions.cs     # –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è –º—ñ–≥—Ä–∞—Ü—ñ–π
‚îú‚îÄ‚îÄ Program.cs                     # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
‚îú‚îÄ‚îÄ appsettings.json              # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–æ–¥–∞—Ç–∫—É
‚îú‚îÄ‚îÄ IdentityAuth.http             # –§–∞–π–ª –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è API
‚îî‚îÄ‚îÄ README.md                     # –¶–µ–π —Ñ–∞–π–ª
```

## üöÄ –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ Identity:
- `POST /register` - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `POST /login` - –í—Ö—ñ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `POST /refresh` - –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞
- `GET /confirmEmail` - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email
- `POST /resendConfirmationEmail` - –ü–æ–≤—Ç–æ—Ä–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
- `POST /forgotPassword` - –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è
- `POST /resetPassword` - –°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è
- `POST /manage/2fa` - –î–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
- `GET /manage/info` - –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### –ö–∞—Å—Ç–æ–º–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏:
- `GET /auth/profile` - –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `PUT /auth/profile` - –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é
- `GET /auth/users` - –°–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **ASP.NET Core 9.0** - –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **ASP.NET Core Identity** - –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- **Entity Framework Core** - ORM –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
- **SQLite** - –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç–∏ —Ä–æ–∑—Ä–æ–±–∫–∏)
- **Swagger/OpenAPI** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API
- **Bearer Token Authentication** - –¢–æ–∫–µ–Ω–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –¥–ª—è API
- **Cookie Authentication** - –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —á–µ—Ä–µ–∑ cookies –¥–ª—è –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
```bash
git clone <repository-url>
cd AspNet.MinimalApi.IdentityAuth
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
dotnet restore
```

### 3. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
```bash
dotnet ef migrations add InitialCreate
```

### 4. –ó–∞–ø—É—Å–∫ –¥–æ–¥–∞—Ç–∫—É
```bash
dotnet run
```

### 5. –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
- API: `https://localhost:7000`
- Swagger: `https://localhost:7000/swagger`

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è HTTP —Ñ–∞–π–ª—É
–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `IdentityAuth.http` –≤ IDE —Ç–∞ –≤–∏–∫–æ–Ω–∞–π—Ç–µ –∑–∞–ø–∏—Ç–∏.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Swagger
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ `https://localhost:7000/swagger`
2. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ `/register`
3. –£–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ `/login` —Ç–∞ —Å–∫–æ–ø—ñ—é–π—Ç–µ —Ç–æ–∫–µ–Ω
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Authorize" –≤ Swagger —Ç–∞ –≤—Å—Ç–∞–≤—Ç–µ —Ç–æ–∫–µ–Ω
5. –¢–µ—Å—Ç—É–π—Ç–µ –∑–∞—Ö–∏—â–µ–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏

### –ü—Ä–∏–∫–ª–∞–¥ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
```json
POST /register
{
  "email": "student@example.com",
  "password": "Student123!"
}
```

### –ü—Ä–∏–∫–ª–∞–¥ –ª–æ–≥—ñ–Ω—É
```json
POST /login
{
  "email": "student@example.com", 
  "password": "Student123!"
}
```

## üîê –ë–µ–∑–ø–µ–∫–∞

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤:
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞: 6 —Å–∏–º–≤–æ–ª—ñ–≤
- –í–∏–º–∞–≥–∞—é—Ç—å—Å—è: –≤–µ–ª–∏–∫—ñ –ª—ñ—Ç–µ—Ä–∏, –º–∞–ª—ñ –ª—ñ—Ç–µ—Ä–∏, —Ü–∏—Ñ—Ä–∏
- –ù–µ –≤–∏–º–∞–≥–∞—é—Ç—å—Å—è: —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è:
- –ú–∞–∫—Å–∏–º—É–º –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±: 5
- –ß–∞—Å –±–ª–æ–∫—É–≤–∞–Ω–Ω—è: 15 —Ö–≤–∏–ª–∏–Ω

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤:
- –¢–µ—Ä–º—ñ–Ω –¥—ñ—ó Bearer —Ç–æ–∫–µ–Ω–∞: 1 –≥–æ–¥–∏–Ω–∞
- –¢–µ—Ä–º—ñ–Ω –¥—ñ—ó Refresh —Ç–æ–∫–µ–Ω–∞: 7 –¥–Ω—ñ–≤
- –¢–µ—Ä–º—ñ–Ω –¥—ñ—ó Cookie: 7 –¥–Ω—ñ–≤

## üìö –ù–∞–≤—á–∞–ª—å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏

### –ö–ª—é—á–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó:
1. **IdentityUser** - –ë–∞–∑–æ–≤–∞ –º–æ–¥–µ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
2. **IdentityDbContext** - –ö–æ–Ω—Ç–µ–∫—Å—Ç –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –¥–ª—è Identity
3. **AddIdentityCore** - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Identity —Å–µ—Ä–≤—ñ—Å—ñ–≤
4. **AddAuthentication** - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
5. **MapIdentityApi** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è API –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ–≤
6. **RequireAuthorization** - –ó–∞—Ö–∏—Å—Ç –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ–≤

### –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:
- [ASP.NET Core Identity](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity)
- [Minimal APIs](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/minimal-apis)
- [Entity Framework Core](https://docs.microsoft.com/en-us/ef/core/)

## üêõ –í—ñ–¥–æ–º—ñ –ø—Ä–æ–±–ª–µ–º–∏

1. **SQLite –æ–±–º–µ–∂–µ–Ω–Ω—è** - –£ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ –∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ PostgreSQL –∞–±–æ SQL Server
2. **Email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è** - –ù–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–∫—É email (–ø–æ—Ç—Ä—ñ–±–µ–Ω SMTP)
3. **HTTPS —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏** - –ú–æ–∂—É—Ç—å –≤–∏–Ω–∏–∫–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –≤ –±—Ä–∞—É–∑–µ—Ä—ñ

## üîÑ –ü–æ–¥–∞–ª—å—à–∏–π —Ä–æ–∑–≤–∏—Ç–æ–∫

- [ ] –î–æ–¥–∞—Ç–∏ —Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- [ ] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–∫—É email
- [ ] –î–æ–¥–∞—Ç–∏ –¥–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
- [ ] –Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ (Google, Facebook)
- [ ] –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è
- [ ] –ü–æ–∫—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–∞–º–∏

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ—î–∫—Ç –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª–µ–π.
