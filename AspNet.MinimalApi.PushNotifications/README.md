# Push Notifications Demo

Демонстрація роботи з пуш-нотифікаціями в ASP.NET Core Minimal API використовуючи Push Protocol та бібліотеку WebPush.

## Особливості

- ✅ **Push Protocol** - використання стандартного Web Push API
- ✅ **VAPID ключі** - безпечна автентифікація
- ✅ **Service Worker** - обробка пуш-повідомлень у фоні
- ✅ **Progressive Web App** - підтримка PWA з маніфестом
- ✅ **Responsive дизайн** - адаптивний інтерфейс
- ✅ **Real-time статистика** - відстеження активних підписок
- ✅ **Логування** - детальні логи для налагодження

## Технології

- **Backend**: ASP.NET Core 9.0 Minimal API
- **Frontend**: Vanilla JavaScript, HTML5, CSS3
- **Push Library**: WebPush 1.0.12
- **Service Worker**: для обробки пуш-повідомлень
- **Web App Manifest**: для PWA функціональності

## Запуск проєкту

1. Переконайтеся, що у вас встановлено .NET 9.0 SDK
2. Клонуйте репозиторій та перейдіть до папки проєкту
3. Запустіть проєкт:
   ```bash
   dotnet run --urls "http://localhost:5285"
   ```
4. Відкрийте браузер та перейдіть за адресою: http://localhost:5285

## Використання

### 1. Підписка на нотифікації
- Натисніть кнопку "Підписатися" на головній сторінці
- Браузер запитає дозвіл на показ нотифікацій
- Після підтвердження ви будете підписані на пуш-нотифікації

### 2. Відправка нотифікацій
- Заповніть форму з заголовком та текстом повідомлення
- Опціонально додайте URL для переходу при кліку на нотифікацію
- **"Відправити нотифікацію"** - відправляє реальну пуш-нотифікацію всім підписникам
- **"Тестова нотифікація"** - симулює відправку без реального пуш-сервісу (для демонстрації)

### 3. Перегляд статистики
- Переглядайте кількість активних підписок
- Оновлюйте статистику кнопкою "Оновити статистику"

## API Endpoints

### GET `/api/vapid-public-key`
Отримати публічний VAPID ключ для підписки

### POST `/api/subscribe`
Підписатися на пуш-нотифікації
```json
{
  "endpoint": "https://...",
  "keys": {
    "p256dh": "...",
    "auth": "..."
  }
}
```

### POST `/api/unsubscribe`
Відписатися від пуш-нотифікацій
```json
{
  "endpoint": "https://..."
}
```

### POST `/api/send-notification`
Відправити нотифікацію всім підписникам
```json
{
  "title": "Заголовок",
  "body": "Текст повідомлення",
  "url": "https://example.com"
}
```

### GET `/api/subscriptions/stats`
Отримати статистику підписок

## Архітектура

### Backend
- **Program.cs** - налаштування Minimal API та endpoints
- **Services/PushNotificationService.cs** - сервіс для роботи з пуш-нотифікаціями
- **Models/PushSubscription.cs** - моделі даних

### Frontend
- **index.html** - головна сторінка з інтерфейсом
- **styles.css** - стилі з градієнтами та анімаціями
- **app.js** - JavaScript логіка для роботи з Push API
- **sw.js** - Service Worker для обробки пуш-повідомлень
- **manifest.json** - маніфест для PWA

## Безпека

- Використовуються VAPID ключі для автентифікації
- Підписки зберігаються в пам'яті (для продакшену рекомендується база даних)
- CORS налаштовано для розробки (для продакшену потрібно обмежити домени)

## Відомі проблеми та рішення

### Помилка 401 Unauthorized
Якщо ви бачите помилки `401 Unauthorized` при відправці нотифікацій:
- Це нормально для демо-проєкту, оскільки VAPID ключі генеруються динамічно
- Використовуйте кнопку **"Тестова нотифікація"** для симуляції
- Для продакшену зберігайте VAPID ключі постійно в конфігурації

### Service Worker не реєструється
- Переконайтеся, що сайт працює через HTTPS (або localhost)
- Очистіть кеш браузера та перезавантажте сторінку
- Перевірте консоль браузера на наявність помилок

## Браузерна підтримка

Push API підтримується в:
- ✅ Chrome 42+
- ✅ Firefox 44+
- ✅ Safari 16+
- ✅ Edge 17+

## Розробка

Для розробки рекомендується:
1. Використовувати HTTPS (для Service Worker)
2. Тестувати в різних браузерах
3. Перевіряти роботу в режимі інкогніто
4. Використовувати Developer Tools для налагодження Service Worker

## Ліцензія

MIT License
