# üöÄ ASP.NET Core Minimal API - –ü—Ä–æ—Å—Ç–∏–π HTTP –°–µ—Ä–≤–µ—Ä

–¶–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ç–æ–≥–æ –∂ HTTP —Å–µ—Ä–≤–µ—Ä–∞, —â–æ —ñ –≤ `NativeHttpServerSimple`, –∞–ª–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º ASP.NET Core Minimal API. –ü—Ä–æ—î–∫—Ç –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –ø—Ä–æ—Å—Ç—ñ—à–∏–º —Å—Ç–∞—î –∫–æ–¥ –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —Å—É—á–∞—Å–Ω–æ–≥–æ –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É.

## üéØ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –Ω–∞—Ç–∏–≤–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ù–∞—Ç–∏–≤–Ω–∏–π HTTP –°–µ—Ä–≤–µ—Ä | ASP.NET Core Minimal API |
|---|---|---|
| **–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É** | ~590 —Ä—è–¥–∫—ñ–≤ | ~150 —Ä—è–¥–∫—ñ–≤ |
| **–ï–∫–æ–Ω–æ–º—ñ—è –∫–æ–¥—É** | - | **75% –º–µ–Ω—à–µ –∫–æ–¥—É!** üéâ |
| **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å** | –í–∏—Å–æ–∫–∞ | –ù–∏–∑—å–∫–∞ |
| **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞** | –í–∞–∂–∫–∞ | –õ–µ–≥–∫–∞ |

## ‚ú® –ü–µ—Ä–µ–≤–∞–≥–∏ ASP.NET Core Minimal API

### üîß **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è**
- ‚úÖ **–†–æ—É—Ç–∏–Ω–≥**: `app.MapGet("/path", handler)` –∑–∞–º—ñ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ switch
- ‚úÖ **Query String**: `request.Query` –∑–∞–º—ñ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥—É
- ‚úÖ **Model Binding**: `[FromForm] IFormCollection` –∑–∞–º—ñ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è
- ‚úÖ **HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏**: `request.Headers` –∑ —Ç–∏–ø—ñ–∑–æ–≤–∞–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º
- ‚úÖ **–õ–æ–≥—É–≤–∞–Ω–Ω—è**: –í–±—É–¥–æ–≤–∞–Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è

### üõ°Ô∏è **–ë–µ–∑–ø–µ–∫–∞ —Ç–∞ –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å**
- ‚úÖ **Anti-forgery –∑–∞—Ö–∏—Å—Ç**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ CSRF
- ‚úÖ **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: –í–±—É–¥–æ–≤–∞–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –º–æ–¥–µ–ª–µ–π
- ‚úÖ **–û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫**: –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –≤–∏–Ω—è—Ç–∫—ñ–≤
- ‚úÖ **HTTPS**: –õ–µ–≥–∫–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SSL/TLS

### üöÄ **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**
- ‚úÖ **Kestrel**: –í–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∏–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- ‚úÖ **Middleware Pipeline**: –ï—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤
- ‚úÖ **Dependency Injection**: –í–±—É–¥–æ–≤–∞–Ω–∏–π DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- ‚úÖ **Configuration**: –ì–Ω—É—á–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

## üåê –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

–°–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª—ñ–∑—É—î —Ç—É –∂ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —â–æ —ñ –Ω–∞—Ç–∏–≤–Ω–∏–π:

### üè† –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ (`/`)
- –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –Ω–∞—Ç–∏–≤–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º
- –ù–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω–µ –º–µ–Ω—é
- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø–æ—Ç–æ—á–Ω–∏–π –∑–∞–ø–∏—Ç

### ‚ÑπÔ∏è –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∑–∞–ø–∏—Ç (`/info`)
- –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ HTTP –∑–∞–ø–∏—Ç
- URL –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
- –ú–µ—Ç–∞–¥–∞–Ω—ñ –∑–∞–ø–∏—Ç—É

### üìã HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ (`/headers`)
- –í—Å—ñ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä —á–µ—Ä–µ–∑ `request.Headers`

### üîç Query String (`/query`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä —á–µ—Ä–µ–∑ `request.Query`
- –ü—Ä–∏–∫–ª–∞–¥–∏ –∑ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏

### üìù –§–æ—Ä–º–∞ (`/form` —Ç–∞ `/submit`)
- HTML —Ñ–æ—Ä–º–∞ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –ø–æ–ª—è–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π model binding —á–µ—Ä–µ–∑ `[FromForm]`
- –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ CSRF (–≤–∏–º–∫–Ω–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç–∏)

## üöÄ –ó–∞–ø—É—Å–∫

1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ .NET 9.0 SDK
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –ø—Ä–æ—î–∫—Ç—É:
   ```bash
   cd AspNet.MinimalApiSimple
   ```
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ø—Ä–æ—î–∫—Ç:
   ```bash
   dotnet run
   ```
4. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä —ñ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ `http://localhost:8083`

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:
- `http://localhost:8083/` - –≥–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞
- `http://localhost:8083/info` - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∑–∞–ø–∏—Ç
- `http://localhost:8083/headers` - HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
- `http://localhost:8083/query?name=–Ü–≤–∞–Ω&age=25` - query –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
- `http://localhost:8083/form` - —Ç–µ—Å—Ç–æ–≤–∞ —Ñ–æ—Ä–º–∞

### –ß–µ—Ä–µ–∑ curl:
```bash
# –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞
curl http://localhost:8083/

# Query –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
curl "http://localhost:8083/query?name=–¢–µ—Å—Ç&city=–ö–∏—ó–≤"

# POST –∑–∞–ø–∏—Ç
curl -X POST http://localhost:8083/submit \
  -d "name=–Ü–≤–∞–Ω&email=ivan@test.com&message=–ü—Ä–∏–≤—ñ—Ç" \
  -H "Content-Type: application/x-www-form-urlencoded"
```

## üíª –ö–ª—é—á–æ–≤—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –≤ –∫–æ–¥—ñ

### –†–æ—É—Ç–∏–Ω–≥
**–ù–∞—Ç–∏–≤–Ω–∏–π —Å–µ—Ä–≤–µ—Ä:**
```csharp
string htmlContent = path switch
{
    "/" => GenerateHomePage(request),
    "/info" => GenerateInfoPage(request),
    // ...
    _ => GenerateNotFoundPage(request)
};
```

**ASP.NET Core Minimal API:**
```csharp
app.MapGet("/", (HttpContext context) => 
    Results.Content(GenerateHomePage(context.Request), "text/html; charset=utf-8"));
app.MapGet("/info", (HttpContext context) => 
    Results.Content(GenerateInfoPage(context.Request), "text/html; charset=utf-8"));
```

### Query String
**–ù–∞—Ç–∏–≤–Ω–∏–π —Å–µ—Ä–≤–µ—Ä:**
```csharp
var queryParams = HttpUtility.ParseQueryString(queryString);
foreach (string key in queryParams.AllKeys)
{
    string value = queryParams[key] ?? "";
    // –†—É—á–Ω–∞ –æ–±—Ä–æ–±–∫–∞
}
```

**ASP.NET Core Minimal API:**
```csharp
foreach (var param in request.Query)
{
    var values = string.Join(", ", param.Value.ToArray());
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä
}
```

### POST –¥–∞–Ω—ñ
**–ù–∞—Ç–∏–≤–Ω–∏–π —Å–µ—Ä–≤–µ—Ä:**
```csharp
using var reader = new StreamReader(request.InputStream, request.ContentEncoding ?? Encoding.UTF8);
string formData = await reader.ReadToEndAsync();
var formParams = HttpUtility.ParseQueryString(formData);
```

**ASP.NET Core Minimal API:**
```csharp
app.MapPost("/submit", async (HttpContext context, [FromForm] IFormCollection form) => 
    Results.Content(await HandleFormSubmit(context, form), "text/html; charset=utf-8"))
    .DisableAntiforgery();
```

## üéì –í–∏—Å–Ω–æ–≤–∫–∏

### ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏ ASP.NET Core Minimal API:
1. **–ú–µ–Ω—à–µ –∫–æ–¥—É**: 75% –µ–∫–æ–Ω–æ–º—ñ—ó –∫–æ–¥—É
2. **–ü—Ä–æ—Å—Ç—ñ—à–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞**: –ú–µ–Ω—à–µ –º—ñ—Å—Ü—å –¥–ª—è –ø–æ–º–∏–ª–æ–∫
3. **–ö—Ä–∞—â–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π Kestrel —Å–µ—Ä–≤–µ—Ä
4. **–ë–µ–∑–ø–µ–∫–∞**: –í–±—É–¥–æ–≤–∞–Ω—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –∑–∞—Ö–∏—Å—Ç—É
5. **–ï–∫–æ—Å–∏—Å—Ç–µ–º–∞**: –í–µ–ª–∏—á–µ–∑–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥–æ—Ç–æ–≤–∏—Ö —Ä—ñ—à–µ–Ω—å
6. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: –õ–µ–≥–∫–µ unit —Ç–∞ integration —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
7. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è OpenAPI/Swagger

### ü§î –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:
- –ù–∞–≤—á–∞–ª—å–Ω—ñ —Ü—ñ–ª—ñ (—Ä–æ–∑—É–º—ñ–Ω–Ω—è –æ—Å–Ω–æ–≤)
- –ú—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏ –∑ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏
- Embedded —Å–∏—Å—Ç–µ–º–∏ –∑ –æ–±–º–µ–∂–µ–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
- –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –≤–∏–º–æ–≥–∏ –¥–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:
–î–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤ **–∑–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ ASP.NET Core** –∞–±–æ —ñ–Ω—à—ñ —Å—É—á–∞—Å–Ω—ñ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏. –ù–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –∫–æ—Ä–∏—Å–Ω–∏–π –ª–∏—à–µ –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –ø—Ä–∞—Ü—é—é—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∏ "–ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º".

## üîÑ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

–¶–µ–π –ø—Ä–æ—î–∫—Ç –º–æ–∂–Ω–∞ —Ä–æ–∑—à–∏—Ä–∏—Ç–∏:
1. –î–æ–¥–∞—Ç–∏ Swagger/OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é
2. –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ Entity Framework –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
3. –î–æ–¥–∞—Ç–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é
4. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ API versioning
5. –î–æ–¥–∞—Ç–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è
6. –ù–∞–ø–∏—Å–∞—Ç–∏ unit —Ç–∞ integration —Ç–µ—Å—Ç–∏
